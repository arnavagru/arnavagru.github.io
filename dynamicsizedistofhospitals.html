<!DOCTYPE html>
<meta charset="utf-8">
<style>
text{
	font-size:12px;
}
.mainBars rect{
  shape-rendering: auto;
  fill-opacity: 0;
  stroke-width: 0.5px;
  stroke: rgb(0, 0, 0);
  stroke-opacity: 0;
}
.subBars{
	shape-rendering:crispEdges;
}
.edges{
	stroke:none;
	fill-opacity:0.5;
}
.header{
	text-anchor:middle;
	font-size:16px;
}
line{
	stroke:grey;
}
</style>
<body>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://vizjs.org/viz.v1.1.0.min.js"></script>
<script>




var data=[
['1: Small ','A & N Islands',2],
['3: Large ','A & N Islands',1],
['2: Mid-sized ','Andhra Pradesh',5],
['3: Large ','Andhra Pradesh',9],
['1: Small ','Arunachal Pradesh',5],
['2: Mid-sized ','Arunachal Pradesh',1],
['1: Small ','Assam',19],
['2: Mid-sized ','Assam',3],
['3: Large ','Assam',3],
['1: Small ','Bihar',32],
['2: Mid-sized ','Bihar',3],
['3: Large ','Bihar',1],
['3: Large ','Chandigarh',1],
['1: Small ','Chhattisgarh',17],
['2: Mid-sized ','Chhattisgarh',1],
['3: Large ','Chhattisgarh',1],
['3: Large ','Dadra & Nagar Haveli',1],
['1: Small ','Daman & Diu',2],
['1: Small ','Delhi',12],
['2: Mid-sized ','Delhi',2],
['3: Large ','Delhi',4],
['2: Mid-sized ','Goa',2],
['1: Small ','Gujarat',11],
['2: Mid-sized ','Gujarat',8],
['3: Large ','Gujarat',2],
['1: Small ','Haryana',16],
['2: Mid-sized ','Haryana',2],
['1: Small ','Himachal Pradesh',3],
['2: Mid-sized ','Himachal Pradesh',8],
['1: Small ','Jammu & Kashmir',20],
['2: Mid-sized ','Jammu & Kashmir',1],
['1: Small ','Jharkhand',22],
['3: Large ','Jharkhand',1],
['1: Small ','Karnataka',6],
['2: Mid-sized ','Karnataka',11],
['3: Large ','Karnataka',23],
['1: Small ','Kerala',2],
['2: Mid-sized ','Kerala',7],
['3: Large ','Kerala',12],
['1: Small ','Lakshadweep',1],
['1: Small ','Madhya Pradesh',20],
['2: Mid-sized ','Madhya Pradesh',18],
['3: Large ','Madhya Pradesh',13],
['1: Small ','Maharashtra',10],
['2: Mid-sized ','Maharashtra',7],
['3: Large ','Maharashtra',8],
['1: Small ','Manipur',7],
['1: Small ','Meghalaya',7],
['3: Large ','Meghalaya',2],
['1: Small ','Mizoram',7],
['2: Mid-sized ','Mizoram',1],
['1: Small ','Nagaland',3],
['1: Small ','Odisha',22],
['2: Mid-sized ','Odisha',5],
['3: Large ','Odisha',5],
['1: Small ','Puducherry',2],
['3: Large ','Puducherry',2],
['1: Small ','Punjab',20],
['2: Mid-sized ','Punjab',1],
['3: Large ','Punjab',1],
['1: Small ','Rajasthan',6],
['2: Mid-sized ','Rajasthan',9],
['3: Large ','Rajasthan',12],
['1: Small ','Sikkim',4],
['1: Small ','Tamil Nadu',5],
['2: Mid-sized ','Tamil Nadu',8],
['3: Large ','Tamil Nadu',19],
['1: Small ','Telangana',2],
['2: Mid-sized ','Telangana',2],
['3: Large ','Telangana',2],
['1: Small ','Tripura',6],
['1: Small ','Uttar Pradesh',128],
['2: Mid-sized ','Uttar Pradesh',13],
['3: Large ','Uttar Pradesh',9],
['1: Small ','Uttarakhand',18],
['1: Small ','West Bengal',1],
['2: Mid-sized ','West Bengal',2],
['3: Large ','West Bengal',17]
];

var color ={"1: Small ":"#E68B92", "2: Mid-sized ":"#FFB7B2",  "3: Large ":"#FFDAC1"};
var svg = d3.select("body").append("svg").attr("width", 1100).attr("height", 800);

svg.append("text").attr("x",250).attr("y",70)
	.attr("class","header").text("Distribution of Hospitals by Size");

var g =[svg.append("g").attr("transform","translate(150,100)")
		,svg.append("g").attr("transform","translate(650,100)")];

var bp=[ viz.bP()
		.data(data)
		.min(12)
		.pad(1)
		.height(600)
		.width(200)
		.barSize(35)
		.fill(d=>color[d.primary])		
	,viz.bP()
		.data(data)
		.value(d=>d[3])
		.min(12)
		.pad(1)
		.height(600)
		.width(200)
		.barSize(35)
		.fill(d=>color[d.primary])
];
		
[0].forEach(function(i){
	g[i].call(bp[i])
	
	g[i].append("text").attr("x",-50).attr("y",-8).style("text-anchor","middle").text("Type");
	g[i].append("text").attr("x", 250).attr("y",-8).style("text-anchor","middle").text("State");
	
	g[i].append("line").attr("x1",-100).attr("x2",0);
	g[i].append("line").attr("x1",200).attr("x2",300);
	
	g[i].append("line").attr("y1",620).attr("y2",620).attr("x1",-100).attr("x2",0);
	g[i].append("line").attr("y1",620).attr("y2",620).attr("x1",200).attr("x2",300);
	
	g[i].selectAll(".mainBars")
		.on("mouseover",mouseover)
		.on("mouseout",mouseout);

	g[i].selectAll(".mainBars").append("text").attr("class","label")
		.attr("x",d=>(d.part=="primary"? -30: 30))
		.attr("y",d=>+6)
		.text(d=>d.key)
		.attr("text-anchor",d=>(d.part=="primary"? "end": "start"));
	
	g[i].selectAll(".mainBars").append("text").attr("class","perc")
		.attr("x",d=>(d.part=="primary"? -120: 150))
		.attr("y",d=>+6)
		.text(function(d){ return d3.format("0.1%")(d.percent)})
		.attr("text-anchor",d=>(d.part=="primary"? "end": "start"));
});

function mouseover(d){
	[0,1].forEach(function(i){
		bp[i].mouseover(d);
		
		g[i].selectAll(".mainBars").select(".perc")
		.text(function(d){ return d3.format("0.1%")(d.percent)});
	});
}
function mouseout(d){
	[0,1].forEach(function(i){
		bp[i].mouseout(d);
		
		g[i].selectAll(".mainBars").select(".perc")
		.text(function(d){ return d3.format("0.1%")(d.percent)});
	});
}
d3.select(self.frameElement).style("height", "800px");
</script>
</body>
</html>